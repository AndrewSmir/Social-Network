{"version":3,"sources":["hoc/withAuthRedirect.js","components/profile/myPosts/profileInfo/ProfileInfo.module.css","components/profile/myPosts/post/Post.module.css","components/profile/ProfileStatusWithHooks.jsx","components/profile/myPosts/profileInfo/ProfileInfo.jsx","components/profile/myPosts/post/Post.jsx","components/profile/myPosts/AddPost.jsx","components/profile/myPosts/MyPostsContainer.jsx","components/profile/Profile.jsx","components/profile/ProfileContainer.jsx"],"names":["withAuthRedirect","Component","RedirectComponent","this","props","isAuth","to","React","connect","state","authReducer","module","exports","ProfileStatusWithHooks","useState","editMode","setEditMode","profileStatus","setProfileStatus","useEffect","onDoubleClick","autoFocus","onBlur","updateUserStatus","value","onChange","event","text","target","type","ProfileInfo","profile","Preloader","className","styles","profileImage","src","alt","photos","small","userPhoto","mainPhoto","isOwner","e","files","length","savePhoto","fullName","Post","item","message","like","maxLength10","maxLength","compose","reduxForm","form","onSubmit","handleSubmit","Field","name","placeholder","component","Textarea","validate","requiredField","postsData","profilePage","postData","dispatch","addPost","newPostText","action","addPostActionCreator","postElements","map","el","index","likes","key","formData","Profile","ProfileContainer","userId","match","params","authorizedUserId","setProfile","getUserStatus","refreshProfile","prevProps","prevState","snapshot","id","setProfileTC","getProfileStatusTC","status","updateProfileStatusTC","file","savePhotoTC","withRouter"],"mappings":"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","file":"static/js/3.ac46e2eb.chunk.js","sourcesContent":["import {Redirect} from \"react-router-dom\";\r\nimport React from \"react\";\r\nimport {connect} from \"react-redux\";\r\n\r\nexport const withAuthRedirect = (Component) => {\r\n\r\n    const mapStateToProps = (state) => {\r\n        return {\r\n            isAuth: state.authReducer.isAuth\r\n        }\r\n    }\r\n\r\n    class RedirectComponent extends React.Component { //Создаем классовый (можно функциональный компонент, который нам вернет HOC\r\n        render() {\r\n            if (!this.props.isAuth) {\r\n                return <Redirect to={'/login'}/> //В зависимости от props вернем либо редирект\r\n            }\r\n            return <Component {...this.props}/> //либо компонент, который мы передаем в качестве аргумента для HOC.\r\n        }\r\n    }\r\n\r\n    const ConnectedAuthRedirectComponent = connect(mapStateToProps, {})(RedirectComponent) //Оборачиваем RedirectComponent connect-om для доступа к props из state\r\n\r\n    return ConnectedAuthRedirectComponent\r\n}\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profileImage\":\"ProfileInfo_profileImage__Z8WVx\",\"mainPhoto\":\"ProfileInfo_mainPhoto__22hmD\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"Post_item__AsE_b\"};","import React, {useEffect, useState} from \"react\";\r\nimport styles from './Profile.module.css'\r\n\r\nconst ProfileStatusWithHooks = (props) => {\r\n    /*\r\n    Хуки нельзя использовать в условиях:\r\n    if(props.profileStatus === 'something){\r\n        const [editMode, setEditMode] = useState(false) -НЕЛЬЗЯ\r\n        }\r\n\r\n     Нельзя испольовать в циклах\r\n     */\r\n\r\n\r\n    //useState(false) //хук useState возвращает нам массив из 2-х элементов. 1-й элемент - параметр, который мы передаем в качестве аргумента в useState. Этот параметр устанавливает initialState компоненты. Второй параметр - функция, которая изменяет первый параметр.\r\n    const [editMode, setEditMode] = useState(false) //деструктурирующим присваиванием получаем наш initial state и функцию, которой мы будем менять стейт\r\n    const [profileStatus, setProfileStatus] = useState(props.profileStatus)\r\n\r\n    useEffect(()=>{\r\n        setProfileStatus(props.profileStatus)\r\n    }, [props.profileStatus])\r\n    //если не передаем второй параметр (массив с зависомостями), то выполняется после каждой отрисовки.\r\n    // если передаем вторым параметром пустой массив, то выполнится один раз после вмотирования в dom\r\n    //useEffect выполняется, когда будет завершена отрисовка страницы, когда она уже будет вмонтирована в dom\r\n    //вторым параметром для useEffect мы передаем массив, элементами которого будут являться зависимости, т.е. то, что будет триггером для срабатывания useEffect.\r\n    //useEffect будет срабатывать только тогда, когда каждая конкретная зависимость не будет равна своему значению из предыдущего рендера.\r\n    //Например, нам пришел props.profileStatus === ''\r\n    //После первого рендера страницы будет запущен useState, т.к. мы устанавливаем первоначальную инициализацию profileStatus.\r\n    //В дальнейшем useEffect будет срабатывать только при изменении props.profileStatus, конкретно в нашем случае после вызова функции deactivateEditMode\r\n\r\n    const activateEditMode = () => {\r\n        setEditMode(true)\r\n    }\r\n\r\n    const deactivateEditMode = () => {\r\n        props.updateUserStatus(profileStatus)\r\n        setEditMode(false)\r\n    }\r\n\r\n    const onStatusChange = (event) => {\r\n        let text = event.target.value\r\n        setProfileStatus(text)\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            {!editMode && <div>\r\n                <span onDoubleClick={() => activateEditMode()}>Status: {props.profileStatus || '-------'}</span>\r\n            </div>}\r\n            {editMode && <div>\r\n                <input autoFocus={true} onBlur={()=> deactivateEditMode()} value={profileStatus} onChange={onStatusChange} type=\"text\"/>\r\n            </div>}\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nexport default ProfileStatusWithHooks","import React from \"react\";\r\nimport styles from './ProfileInfo.module.css'\r\nimport Preloader from \"../../../common/Preloader/Preloader\";\r\nimport ProfileStatusWithHooks from \"../../ProfileStatusWithHooks\";\r\nimport userPhoto from \"../../../../assets/img/user.jpeg\";\r\n\r\nconst ProfileInfo = props => { //Все, что нужно компоненте не импортируется, не берется из глобала, а поступает из пропсов\r\n    if (!props.profile) {\r\n        return <Preloader/>\r\n    }\r\n\r\n    const onMainPhotoSelected = (e) => {\r\n        if (e.target.files.length) {\r\n            props.savePhoto(e.target.files[0])\r\n        }\r\n    }\r\n\r\n    return (\r\n            <div>\r\n                <img className={styles.profileImage}\r\n                     src=\"https://process.images.nathab.com/A6dTpd53SmIg0pBfJJhgAz/resize=width:864/quality=value:60/cache=expiry:31536000/compress/https://www.nathab.com/uploaded-files/carousels/HERO/South-America/83-ALT.jpg\"\r\n                     alt=\"IMG\"/>\r\n                <div>\r\n                <img src={props.profile.photos.small || userPhoto} alt=\"photo\" className={styles.mainPhoto}/>\r\n                    {props.isOwner && <input type=\"file\" onChange={onMainPhotoSelected}/>}\r\n                <p>Name: {props.profile.fullName}</p>\r\n                    <ProfileStatusWithHooks profileStatus={props.profileStatus} updateUserStatus={props.updateUserStatus}/>\r\n            </div>\r\n            </div>\r\n        )\r\n\r\n}\r\n\r\nexport default ProfileInfo","import React from \"react\";\r\nimport styles from \"./Post.module.css\"\r\n\r\nfunction Post(props) {\r\n    return (\r\n        <div className={styles.item}>\r\n            <img\r\n                src=\"https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcRsLfGk8cfZYn-FlJfh4I9rPP656klMZAF6Og&usqp=CAU\"\r\n                alt=\"avatar\"/>\r\n            <span>{props.message}</span>\r\n            <div>\r\n                <span>Like - {props.like}</span>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Post","import React from \"react\";\r\nimport {Field, reduxForm} from \"redux-form\";\r\nimport {compose} from \"redux\";\r\nimport {maxLength, requiredField} from \"../../../utils/validators/validators\";\r\nimport {Textarea} from \"../../common/FormsControl/FormsControls\";\r\n\r\nconst maxLength10 = maxLength(1000)\r\n\r\nconst AddPost = (props) => {\r\n    return (\r\n            <form onSubmit={props.handleSubmit}>\r\n                <div>\r\n                    <Field name={'newPostText'} placeholder='Enter your post' component={Textarea} validate={[maxLength10, requiredField]}>\r\n                    </Field>\r\n                </div>\r\n                <div>\r\n                    <button >Add post</button>\r\n                </div>\r\n            </form>\r\n    )\r\n}\r\n\r\nexport default compose(\r\n    reduxForm({form:'addPost'})\r\n)(AddPost)","import React from \"react\"\r\nimport {addPostActionCreator} from \"../../../redux/profile-reducer\";\r\nimport {connect} from \"react-redux\";\r\nimport Post from \"./post/Post\";\r\nimport AddPost from \"./AddPost\";\r\n\r\nconst MyPostsContainer = props => {\r\n\r\n    const postElements = props.postsData.map((el, index) => <Post message={el.message}\r\n                                                                  like={el.likes} key={index}/>);\r\n\r\n    const onSubmit = (formData) => {\r\n        props.addPost(formData.newPostText)\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            My posts\r\n            <AddPost onSubmit={onSubmit}/>\r\n            {postElements}\r\n        </div>\r\n    )\r\n};\r\n\r\n\r\nconst mapStateToProps = (state) => {\r\n     return {\r\n         postsData: state.profilePage.postData,\r\n     }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n     return {\r\n         addPost: (newPostText) => {\r\n             const action = addPostActionCreator(newPostText)\r\n             dispatch(action);\r\n         },\r\n     }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MyPostsContainer)","import React from \"react\";\r\nimport styles from \"./Profile.module.css\"\r\nimport ProfileInfo from \"./myPosts/profileInfo/ProfileInfo\"\r\nimport MyPosts from \"./myPosts/MyPostsContainer\";\r\n\r\n\r\nfunction Profile(props) {\r\n\r\n    return (\r\n        <div>\r\n            <ProfileInfo profile={props.profile} profileStatus={props.profileStatus} updateUserStatus={props.updateUserStatus} isOwner={props.isOwner} savePhoto={props.savePhoto}/>\r\n            <MyPosts />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Profile;","import React, {Component} from \"react\";\r\nimport Profile from \"./Profile\";\r\nimport {connect} from \"react-redux\";\r\nimport {getProfileStatusTC, savePhotoTC, setProfileTC, updateProfileStatusTC} from \"../../redux/profile-reducer\";\r\nimport {withRouter} from \"react-router-dom\";\r\nimport {withAuthRedirect} from \"../../hoc/withAuthRedirect\";\r\nimport {compose} from \"redux\";\r\n\r\nclass ProfileContainer extends Component { //Задача контейнерной компоненты - быть оберткой для презентационной компоненты.\r\n\r\n    refreshProfile(){\r\n        let userId = this.props.match.params.userId; //props.match.params.userId - эти пропсы нам добавляет HOC withRouter\r\n\r\n        if (!userId){\r\n            userId = this.props.authorizedUserId;\r\n        }\r\n\r\n        this.props.setProfile(userId)\r\n        this.props.getUserStatus(userId)\r\n    }\r\n\r\n    componentDidMount() { //Делаем ajax запросы в методе componentDidMount, т.к. получаение данных - асинхронный процесс. Если будем делать запрос на сервер до того, как наша компонента будет вмонтирована, то есть риск, что мы не сможем ничего отрисовать, например, из-зи проблем с сетью\r\n        this.refreshProfile()\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        if (this.props.match.params.userId != prevProps.match.params.userId) {\r\n            this.refreshProfile()\r\n        }\r\n    }\r\n\r\n    render() {\r\n\r\n        return(\r\n            <div>\r\n                <Profile {...this.props} profile={this.props.profile} isOwner={!this.props.match.params.userId} savePhoto={this.props.savePhoto}/>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        profile: state.profilePage.profile,\r\n        profileStatus: state.profilePage.profileStatus,\r\n        authorizedUserId: state.authReducer.id,\r\n        isAuth: state.authReducer.isAuth\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        setProfile: (userId) => {\r\n            dispatch(setProfileTC(userId))\r\n        },\r\n        getUserStatus: (userId) => {\r\n            dispatch(getProfileStatusTC(userId))\r\n        },\r\n        updateUserStatus: status => {\r\n            dispatch(updateProfileStatusTC(status))\r\n        },\r\n        savePhoto: (file) => {\r\n            dispatch(savePhotoTC(file))\r\n        }\r\n    }\r\n}\r\n\r\n// withRouter(ProfileContainer); вернет нам новую компоненту, в props которой добавятся объекты\r\n// match, location, history, staticContext\r\n\r\n/*\r\nlocation:\r\n    hash: \"\"\r\n    key: \"sxa9ph\"\r\n    pathname: \"/profile/11722\"\r\n    search: \"\"\r\n    state: null\r\n\r\nmatch: - показывает совпадение url с какими-либо Route path. В нашем случае было найдено совпадение с <Route path='/profile'\r\n    isExact: false (или true) - совпал ли адрес в url строке точно. Т.к. наш path - \"/profile/11722\", то значение false\r\n    params: {11722} - сюда нам приходят параметры, которые указаны у Route path='/profile/: после двоеточия\r\n    path: \"/profile\"\r\n    url: \"/profile\"\r\n */\r\n\r\nexport default compose(\r\n    connect(mapStateToProps, mapDispatchToProps),\r\n    withRouter,\r\n    withAuthRedirect)\r\n(ProfileContainer)\r\n"],"sourceRoot":""}